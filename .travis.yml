language: julia

os:
  - linux
  - osx

julia:
  - 0.4
  - nightly

branches:
  only:
    - master

matrix:
  allow_failures:
    - julia: nightly
    - os: osx

script:
 - if [[ -a .git/shallow ]]; then git fetch --unshallow; fi
 - julia --check-bounds=yes -e 'Pkg.clone("https://psl-travis-user:6mnZDX4Hf04Kcn1S2gog@github.com/IntelLabs/CompilerTools.jl.git")' # Pull in CompilerTools dependency
 - julia --check-bounds=yes -e 'Pkg.build("CompilerTools")'
 - julia --check-bounds=yes -e 'Pkg.clone(pwd()); Pkg.build("ParallelAccelerator"); Pkg.test("ParallelAccelerator"; coverage=true)'
 # Run examples.
 - julia examples/black-scholes/black-scholes.jl
 - julia examples/gaussian-blur/gaussian-blur.jl
 - julia examples/harris/harris.jl
